AWSTemplateFormatVersion: 2010-09-09
Resources: 
  BastionVPC:
    Type:  AWS::EC2::VPC
    Properties: 
      CidrBlock: 10.0.0.0/16
  
  BastionSubnet:
    Type: AWS::EC2::Subnet
    Properties:
      CidrBlock: 10.0.0.0/24
      VpcId: !Ref BastionVPC
      
  InternetGateway:
    Type: AWS::EC2::InternetGateway
    Properties: {}
    
  EC2VPC:
    Type: AWS::EC2::VPCGatewayAttachment
    Properties:
      VpcId: !Ref BastionVPC
      InternetGatewayId: !Ref InternetGateway
      
  BastionHost:
    Type: 'AWS::EC2::Instance'
    Properties:
      InstanceType: t2.micro
      ImageId: ami-0a887e401f7654935
      SubnetId: !Ref BastionSubnet
      
  MyEIP:
    Type: AWS::EC2::EIP
    Properties:
      InstanceId: !Ref BastionHost
    
    
    
    
    
    
    
  InstanceSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: Allow http to client host
      VpcId:
         Ref: BastionVPC
      SecurityGroupIngress:
      - IpProtocol: tcp
        FromPort: 80
        ToPort: 80
        CidrIp: 0.0.0.0/0
      SecurityGroupEgress:
      - IpProtocol: tcp
        FromPort: 80
        ToPort: 80
        CidrIp: 0.0.0.0/0    
    
    
    
--------ABOVE IS WORKING=====   
    
    
  MyEIP:
    Type: AWS::EC2::EIP
     Properties:
       InstanceId: 
       Ref: BastionHost
            


